<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="../../assets/css/profilepage.css">
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
<body>
<section class="wrapper">
    <div class="form signup">
        <header>Profile Details</header>
        <form>
            <label>
                <input type="text" id="first_name" placeholder="First name" disabled />
            </label>
            <label for="">
                <input type="text" id="last_name" placeholder="Last name" disabled />
            </label>
            <label for="">
                <input type="text" id="email" placeholder="Email address" disabled />
            </label>
            <label for="">
                <input id="password" placeholder="Password" disabled />
            </label>
            <label for="">
                <input type="number" id="ph_no" placeholder="Phone Number" disabled min="10" max="10"/>
            </label>

            <button id="edit_removal">Edit Profile</button>
            <button id="save">Save Profile</button>
            <button id="delete_item">Delete profile</button>
        </form>
    </div>



</section>


<script>

    let edit_btn = document.getElementById("edit_removal");
    edit_btn.style.display=""

    let save = document.getElementById("save");
    save.style.display = "none"

    edit_btn.addEventListener("click", display)
    function display() {
        let save = document.getElementById("save");
        save.style.display = ""
        edit_btn.style.display="none";

    }


    let users = JSON.parse(localStorage.getItem("user_signup_list"));

    const firstname = document.getElementById("first_name")
    const lastname = document.getElementById("last_name")
    const email_name = document.getElementById("email")
    const password = document.getElementById("password")
    const phone = document.getElementById("ph_no");


    let profile_arr = JSON.parse(localStorage.getItem("profile_details"));

    let check;

    users.find((userobj) => {
        if (userobj["email"] == profile_arr["email"] && userobj["password"] == profile_arr["password"]) {

            firstname.value = userobj["first_name"]
            lastname.value = userobj["last_name"]
            phone.value = userobj["ph_no"]
            email_name.value = userobj["email"]
            password.value = userobj["password"]
            return check = userobj;
        }
    })

    document.getElementsByTagName("form")[0].addEventListener("submit", (e) => {
        e.preventDefault();
        edit();
    })

    function edit() {
        document.getElementById("first_name").disabled = false;
        document.getElementById("last_name").disabled = false;
        document.getElementById("password").disabled = false;
        document.getElementById("ph_no").disabled = false;

        let save = document.getElementById("save");
        save.classList.remove("save_profile");
    }


    document.getElementById("save").addEventListener("click", (e) => {

        check["first_name"] = document.getElementById("first_name").value;
        check["last_name"] = document.getElementById("last_name").value;
        check["password"] = document.getElementById("password").value;
        check["ph_no"] = document.getElementById("ph_no").value;

        console.log(check)

        localStorage.setItem("user_signup_list", JSON.stringify(users));

        console.log(users);



    })

    document.getElementById("delete_item").addEventListener("click",deleteItem)
    function deleteItem() {
        for (let i = 0; i < users.length; i++) {
            if (document.getElementById("email").value == users[i]["email"]) {
                users.splice(i, 1)
                confirm("Are you sure to delete your account")
                localStorage.setItem("user_signup_list", JSON.stringify(users));

                window.location.href = "user-entry.html";
            }
        }

        let save = document.getElementById("save");
        save.style.display = "none";
    }

</script>
</body>
</html>
